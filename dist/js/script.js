"use strict";$(document).ready(function(){var e,o=$(".form");function c(e){return e.nextElementSibling.textContent=e.validationMessage,e.checkValidity()}$(".submit").on("click",function(e){var n,t,a,i=this;e.preventDefault(),e=o,a=!0,c($("input[name=name]",e).get(0))||(a=!1),c($("input[name=phone]",e).get(0))||(a=!1),(a=!!c($("textarea[name=comment]",e).get(0))&&a)&&(n=[],$("input[name^=address]",o).each(function(){return n.push($(i).val())}),e={name:$("input[name=name]",o).eq(0).val(),phone:$("input[name=phone]",o).eq(0).val(),comment:$("textarea[name=comment]",o).eq(0).val(),to:"mail@mail.ru"},(t=new XMLHttpRequest).responseType="json",t.open("POST","https://webdev-api.loftschool.com/sendmail"),t.setRequestHeader("content-type","application/json"),t.send(JSON.stringify(e)),t.addEventListener("load",function(){var e;e=t.response.status,r.fadeIn(400),s.fadeIn(400,function(){e?$(".modal__text").html("Отправка удалась"):$(".modal__text").html("Произошла ошибка")}),$("body").addClass("lock"),t.response.status&&o[0].reset()}))});ymaps.ready(function(){e=new ymaps.Map("map",{center:[55.752,37.5761],zoom:16,controls:[]});var n=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/content/marker.svg",iconImageSize:[44,54],iconImageOffset:[-22,-54]});[[55.752004,37.576133]].forEach(function(e){n.add(new ymaps.Placemark(e))}),e.geoObjects.add(n),e.behaviors.disable("scrollZoom"),e.behaviors.disable("drag")});var n=$("#mobile-menu-open"),t=$("#mobile-menu-close"),a=$(".mobile-menu"),i=$(".mobile-menu__list"),r=(n.on("click",function(e){e.preventDefault(),a.fadeIn(400)}),t.on("click",function(e){e.preventDefault(),a.fadeOut(400)}),i.children().on("click",function(e){e.preventDefault();e=i.children().index($(this));a.fadeOut(400,b(e+1))}),$(".overlay")),s=$(".modal");$(".overlay, .modal").on("click",function(){r.fadeOut(400,function(){return $("body").removeClass("lock")}),s.fadeOut(400,function(){return $(".modal__text").html("&nbsp;")})});for(var l=$("section"),d=$(".maincontent"),n=new MobileDetect(window.navigator.userAgent),u=$(".fixed-menu"),m=$(".fixed-menu__list"),_=$(".fixed-menu__item"),t=n.mobile(),v=!1,p=_.length;p<l.length;p++){var f=_.first().clone();m.append(f)}l.first().addClass("active"),_.first().addClass("fixed-menu__item--active");function h(e,n,t){e.eq(n).addClass(t).siblings().removeClass(t)}function g(){var e=l.filter(".active"),n=e.next(),t=e.prev();return{next:function(){n.length&&b(n.index())},prev:function(){t.length&&b(t.index())}}}function k(e){e.removeClass("accordion__descr--active"),$(".accordion__title").removeClass("accordion__title--opened"),e.parent().addClass("accordion__item--closed"),$(".accordion__item--closed").length===$(".accordion__item").length&&$(".accordion__item--closed").removeClass("accordion__item--closed")}var C,_=$(".fixed-menu__item"),b=function(e){var n,t;v||(v=!0,n=function(e){e*=-100;return isNaN(e)?0:e}(e),t="fixed-menu--dark","light"===l.eq(e).attr("data-section-theme")?u.addClass(t):u.removeClass(t),d.css({transform:"translateY(".concat(n,"%)")}),h(l,e,"active"),h(_,e,"fixed-menu__item--active"),setTimeout(function(){v=!1},1300))},y=($(window).on("wheel",function(e){var e=e.originalEvent.deltaY,n=g();0<e&&n.next(),e<0&&n.prev()}),$(window).on("keydown",function(e){var n=e.target.tagName.toLowerCase(),n="input"===n||"textarea"===n,t=g();if(!n)switch(e.keyCode){case 38:t.prev();break;case 40:t.next()}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),_.on("click",function(e){e.preventDefault();e=_.index($(this));b(e)}),t&&$("body").swipe({swipe:function(e,n){g()["down"===n?"prev":"up"===n?"next":""]()}}),$("a.btn").not(".mobile-menu a").on("click",function(e){e.preventDefault();e=$(".order"),e=$(".section").index(e);b(e)}),$(".player__video")[0]),x=$(".player__start"),n=(y.addEventListener("canplay",function(e){var n;void 0===C&&(C=y.duration),void 0!==n&&clearInterval(n),setInterval(function(){var e=y.currentTime,e=Math.round(e/C*100),n=y.volume,t=Math.round(100*n);$(".player__playback input").css({"background-size":"".concat(e,"% 100%")}),$(".player__playback input").val(e),$(".volume__scale input").css({"background-size":"".concat(t,"% 100%")}),$(".volume__scale input").val(n)},1e3)}),y.addEventListener("playing",function(){$(".player__splash").hide(),x.addClass("paused"),$(y).on("click",function(){return y.pause()})}),y.addEventListener("pause",function(){x.removeClass("paused"),$(y).on("click",function(){return y.play()})}),x.on("click",function(e){e.preventDefault(),$(e.currentTarget).hasClass("paused")?y.pause():y.play()}),$(".player__splash").on("click",function(e){return y.play()}),$(".player__playback input").on("input",function(e){e.preventDefault(),void 0===C&&(C=y.duration);var e=$(this).val(),n=Math.round(C*e/100);y.currentTime=n,$(".player__playback input").css({"background-size":"".concat(e,"% 100%")})}),$(".volume__scale input").on("input",function(e){e.preventDefault();var e=$(this).val(),n=100*e;y.volume=e,$(".volume__scale input").css({"background-size":"".concat(n,"% 100%")})}),$(".volume__speaker").on("click",function(e){e=$(e.currentTarget);e.hasClass("volume__speaker--active")?(e.removeClass("volume__speaker--active"),y.muted=!0):(e.addClass("volume__speaker--active"),y.muted=!1)}),$(".accordion__name").on("click",function(e){e.preventDefault();var e=$(this).siblings(".accordion__descr");e.hasClass("accordion__descr--active")?k(e):(e=e,k($(".accordion__list .accordion__descr").not(e)),e.addClass("accordion__descr--active"),$(".accordion__title").addClass("accordion__title--opened"),e.parent().removeClass("accordion__item--closed"))}),$(".accordion__title").on("click",function(e){e.preventDefault(),k($(".accordion__list .accordion__descr"))}),$(".accordion__descr").on("click",function(e){e.preventDefault(),k($(".accordion__list .accordion__descr"))}),$("#slider-control-left")),t=$("#slider-control-right"),w=$(".slider__list"),D=w.outerWidth();function q(e){e.removeClass("team__name--active"),e.siblings(".team__content").removeClass("team__content--active"),e.siblings(".team__photo").removeClass("team__photo--active")}t.on("click",function(e){e.preventDefault();var n=w.children().first();n.animate({"margin-left":"-"+D+"px"},400,function(){w.append(n),n.css({"margin-left":0})})}),n.on("click",function(e){e.preventDefault();e=w.children().last();w.prepend(e),e.css({"margin-left":"-"+D+"px"}),e.animate({"margin-left":0},400)}),$(".team__name").on("click",function(e){e.preventDefault();var e=$(this);e.hasClass("team__name--active")?q(e):(e=e,q($(".team__item .team__name").not(e)),e.addClass("team__name--active"),e.siblings(".team__content").addClass("team__content--active"),e.siblings(".team__photo").addClass("team__photo--active"))});var O=$(".reviews__switcher"),I=$(".reviews__display"),E="interactive-avatar--active",L="reviews__display-inner--active";O.find("a").on("click",function(e){e.preventDefault();var e=$(this).parent();e.hasClass(E)||(e=(e=e).index(),O.children().removeClass(E),I.children().removeClass(L),O.children().eq(e).addClass(E),I.children().eq(e).addClass(L))})});